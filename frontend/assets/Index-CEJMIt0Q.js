import{a as i,j as e,u as ee,i as c,t as d,c as D,p as S,L as se,q as oe,s as ae}from"./index-BbnLkFbA.js";import{u as P,b,a as te}from"./react-spring_web.modern-DD1c5-wo.js";import{m as ne}from"./BahiaRegiao2-BAhF5orp.js";import{r as ie}from"./BahiaCidades4-BL7XSpt6.js";import{M as re,U as le,a as ce,P as de,A as me}from"./user-CQLo8XHS.js";import{r as w}from"./heading-edCDQISV.js";import{o as $}from"./card-A99miB_4.js";import{C as pe,u as ge,g as xe,y as he,h as ue,v as fe}from"./select-BFV75yO_.js";import{o as je}from"./separator-B4fbzUw-.js";import{o as ve}from"./button-DvBvv6ln.js";const ye="/assets/bg_main2-DoB-hKAm.png",we=({fillColor:m,strokeColor:u})=>e.jsx("path",{d:"M26.4 6c-1.1-1.8-2.5-3.2-4.4-4.4S18.2 0 16 0s-4.2.6-6 1.6C8.1 2.7 6.7 4.2 5.6 6 4.5 7.8 4 9.8 4 12c-.1 1 .2 2 .7 3.2s1.1 2.4 1.7 3.6c.6 1.2 1.4 2.5 2.4 3.8s1.8 2.5 2.5 3.5 1.5 2 2.4 3c.9 1 1.4 1.7 1.7 2 .3.3.5.6.7.8l.7-.7c.4-.5 1-1.2 1.7-2.1.7-.9 1.5-1.8 2.3-2.9.8-1.1 1.7-2.3 2.6-3.6.9-1.3 1.7-2.5 2.3-3.8.7-1.2 1.2-2.5 1.7-3.7.4-1.1.6-2.2.6-3.1 0-2.2-.5-4.2-1.6-6z",fill:m,stroke:u,strokeWidth:"1.2",overflow:"visible"}),be=({x:m,y:u,imageUrl:r,tooltipContent:_,level:f,isActive:p,isAnyPinActive:j,onClick:R})=>{const[g,t]=i.useState(!1),M=.8,x=1.2,[z,v]=P(()=>({scale:M,yOffset:0,opacity:1,config:{tension:300,friction:15}}));i.useEffect(()=>{const h=f===0?M:x,B=g||p?h*1.2:h,F=g||p?-5:0,I=j&&!p?.5:1;v.start({scale:B,yOffset:F,opacity:I})},[f,g,p,j,v]);const L=()=>t(!0),N=()=>t(!1),y=18;return e.jsx(b.g,{transform:z.scale.to(h=>`translate(${m}, ${u}) scale(${h})`),opacity:z.opacity,onClick:R,onMouseEnter:L,onMouseLeave:N,style:{cursor:"pointer",willChange:"transform"},children:e.jsxs("g",{transform:"translate(-16, -32)",children:[" ",e.jsx(ee,{content:_,children:e.jsxs("g",{children:[e.jsx(we,{fillColor:p?"#facc15":"#FFFFFF",strokeColor:"#333"}),r&&e.jsx("image",{href:r,x:16-y/2,y:12-y/2,height:y,width:y,clipPath:"circle(50% at center)"})]})})]})})},H=6,C=ie,q=ne,Re=()=>{const m=i.useRef(null),u=i.useRef(null),[r,_]=i.useState(0),[f,p]=i.useState({active:"bahia",name:"Bahia"}),j=(s,o)=>{p({active:s,name:o})},[R,g]=i.useState({visible:!1,content:"",x:0,y:0}),[t,M]=i.useState(null),[x,z]=i.useState([]);i.useEffect(()=>{if(m.current&&!u.current){const o=m.current.getBBox();u.current=o,console.log("BBox Original CAPTURADO:",o)}(async()=>{try{const o=await oe.get("/map-markers/");z(o.data)}catch(o){console.error("Falha ao buscar instituições:",o)}})()},[]);const v=[0,0,601,640],[{viewBox:L},N]=P(()=>({viewBox:v,config:{tension:62,friction:35,mass:7}})),y=i.useMemo(()=>{const s={};for(const[o,a]of Object.entries(C))for(const n of a)s[n.id]=o;return s},[]),h=s=>{console.log("Marcador clicado:",s.nome),M(s);const o=y[s.cidade_id_mapa];if(!o){console.error("Não foi possível encontrar a região para o marcador:",s.cidade_id_mapa);return}const a=q.find(E=>E.id===o);if(!a){console.error("Dados da região não encontrados:",o);return}const n=B.get(s.cidade_id_mapa);if(!n){console.error("Coordenadas da cidade não encontradas para o marcador:",s.cidade_id_mapa);return}_(1),j(o,a.name);const l=n.x+(s.offset_x||0),k=n.y+(s.offset_y||0);V(l,k)},B=i.useMemo(()=>{const s=new Map;for(const o of Object.values(C))for(const a of o)s.set(a.id,{x:a.x,y:a.y});return s},[]),F=P({opacity:r===1?0:1,config:{duration:300}}),I=te(C[f.active]||[],{trail:600/C[f.active].length||1,from:{opacity:0,transform:"scale(0)"},enter:{opacity:1,transform:"scale(1)"},leave:{opacity:0,transform:"scale(0)"},config:{mass:10,tension:63,friction:16,clamp:!0},keys:(C[f.active]||[]).map(s=>s.id)}),V=(s,o)=>{const[a,n,l,k]=v,E=l/H,T=k/H,J=s-E/2,Q=o-T/2;N.start({viewBox:[J,Q,E,T]})},X=s=>{const a=s.width+60,n=s.height+30*2,l=s.x-30,k=s.y-30;N.start({viewBox:[l,k,a,n]})},G=s=>{const o=s.target,a=o==null?void 0:o.id,n=o==null?void 0:o.getAttribute("data-type"),l=o==null?void 0:o.getAttribute("data-name");r===0&&n==="region"&&a!=="bahia_stroke"&&(_(1),j(a,l||""),X(o.getBBox())),console.log("target id:",a),console.log("target type:",n),console.log("level:",r),console.log("✦────────────────────────────➤"),r===1&&(n==="city"?console.log("Cidade clicada:",a):A())},A=()=>{_(0),j("bahia","Bahia"),N.start({viewBox:v}),M(null)},U=i.useMemo(()=>t?[...x.filter(o=>o.id!==t.id),t]:x,[x,t]),Y=s=>{if(!s){A();return}const o=x.find(a=>a.id===Number(s));o&&h(o)},W=({visible:s,content:o,x:a,y:n})=>{const l=P({opacity:s?1:0,transform:s?"translate3d(0,0,0)":"translate3d(0,10px,0)",config:{tension:300,friction:20}});return ae.createPortal(e.jsx(b.div,{style:{position:"absolute",top:n,left:a,pointerEvents:"none",zIndex:1e3,...l},className:"bg-gray-800 text-white text-sm px-3 py-1 rounded-md shadow-lg",children:o}),document.body)},O=s=>{const o=s.currentTarget.getAttribute("data-name");o&&g(a=>({...a,visible:!0,content:o}))},K=s=>{const o=s.pageX+12,a=s.pageY+12;g(n=>({...n,x:o,y:a}))},Z=()=>{g(s=>({...s,visible:!1}))};return e.jsx(e.Fragment,{children:e.jsxs(c,{id:"CANVAS",className:"flex flex-col gap-6 px-4 pb-4 pt-36 md:px-6 md:pb-8 md:pt-28 lg:px-12 lg:pb-14 lg:pt-32",children:[e.jsxs(c,{id:"PANEL1",className:"flex flex-col-reverse lg:flex-row w-full mb-12 gap-8",children:[e.jsxs(c,{id:"TEXT_HEADER",className:"flex flex-col gap-8 justify-between items-center w-full lg:w-1/2 text-left",children:[e.jsx(w,{color:"gray",size:"6",className:"text-balance text-center break-words hyphens-none",children:"Instituto de Ciência, Inovação e Tecnologia do Estado da Bahia"}),e.jsxs(w,{size:{initial:"7",md:"9"},className:"text-balance text-center break-words hyphens-none",children:["Incite - ",e.jsx("span",{className:"text-green-700",children:"Agricultura Familiar"})," Diversificada e Sustentável"]}),e.jsx(d,{className:"pt-10 px-4",children:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur."}),e.jsxs($,{variant:"ghost",id:"Intituicao-Text-Selector",children:[e.jsx(w,{as:"h3",size:"4",mb:"2",children:"Navegar por Instituição"}),e.jsxs(pe,{value:t?t.id.toString():"",onValueChange:Y,children:[e.jsx(ge,{placeholder:"Escolha uma instituição na lista...",className:"w-full"}),e.jsx(xe,{position:"popper",children:e.jsxs(he,{children:[e.jsx(ue,{children:"Instituições"}),x.map(s=>e.jsx(fe,{value:s.id.toString(),children:s.nome},s.id))]})})]})]})]}),e.jsx(c,{id:"LOGO_HEADER",className:"flex h-[420px] md:h-[490px] lg:h-[600px] w-full lg:w-1/2 justify-center ",style:{backgroundImage:`url(${ye})`,backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat"},children:e.jsx("svg",{children:e.jsx("circle",{r:100,cx:"50%",cy:"50%",fill:"#FFEB3B"})})})]}),e.jsxs(c,{id:"PANEL2",className:D("flex flex-col items-center w-full gap-10 mb-24,","lg:flex-row lg:items-start lg:justify-evenly lg:gap-6"),children:[e.jsx(c,{id:"map-panel",className:"flex flex-col w-full max-w-full lg:w-auto",children:e.jsx("div",{className:"w-full overflow-x-auto rounded-3xl",children:e.jsxs("div",{id:"canvas-wrapper",className:`\r
                                    relative bg-transparent flex-shrink-0\r
                                    w-full aspect-square overflow-hidden\r
                                    lg:w-[602px] lg:h-[640px] lg:aspect-auto\r
                                    `,children:[e.jsx(W,{...R}),e.jsx(b.svg,{id:"SVGCanvas",ref:m,viewBox:L.to((...s)=>s.join(" ")),overflow:"visible",style:{width:"100%",height:"100%",cursor:"pointer"},onClick:G,onMouseMove:K,onMouseLeave:Z,children:e.jsxs("g",{children:[e.jsx("defs",{children:e.jsxs("style",{children:[".cls-1{fill:#f4f4f4;stroke:#a5a5a5}",".cls-1, .cls-2{stroke-linecap:round;stroke-linejoin:round}",".cls-2{fill:none;stroke:#000;stroke-width:2px}"]})}),q.map((s,o)=>{const a=s.id==="bahia_stroke"?"cls-2":"cls-1 path-hover2",n=s.id==="bahia_stroke"?F:{};return e.jsx("g",{children:e.jsx(b.path,{id:s.id,d:s.d,"data-name":s.name,"data-type":"region",className:a,style:n,onMouseEnter:O})},o)})," // . . .",r===1&&e.jsx("rect",{opacity:.95,x:-2e3,y:-2e3,width:"4000",height:"4000",fill:"white",onClick:s=>{s.stopPropagation(),A()}}),I((s,o)=>e.jsx(b.g,{...s,children:e.jsx(b.path,{id:o.id,d:o.d,"data-name":o.name,"data-type":"city",className:D("path-hover2","cls-1"),onMouseEnter:O})}))," //. . .",U.map(s=>{const o=B.get(s.cidade_id_mapa);return o?e.jsx(be,{x:o.x+(s.offset_x||0),y:o.y+(s.offset_y||0),imageUrl:s.marcador_logo,tooltipContent:e.jsx(d,{size:"2",weight:"bold",children:s.nome}),level:r,isActive:(t==null?void 0:t.id)===s.id,isAnyPinActive:t!==null,onClick:a=>{a.stopPropagation(),h(s)}},`inst-${s.id}`):null})," //. . ."]})})]})})}),e.jsx("div",{className:`\r
                            hidden lg:block\r
                            w-[3px]\r
                            bg-gradient-to-b from-green-700 via-green-600 to-green-700\r
                            h-[700px]\r
                            mx-4\r
                            rounded-full\r
                            shadow-inner`}),e.jsx($,{id:"info-panel",variant:"ghost",className:"w-full lg:w-[500px] p-4 overflow-y-auto",style:{minHeight:"400px",maxHeight:"600px"},children:t?e.jsxs(e.Fragment,{children:[e.jsxs(S,{gap:"5",align:"center",children:[t.marcador_logo&&e.jsx("img",{src:t.marcador_logo,alt:`${t.nome} logo`,className:" w-[100px] h-auto rounded"}),e.jsxs(c,{children:[e.jsx(w,{as:"h2",size:"6",mb:"4",children:t.nome}),e.jsxs(S,{align:"center",gap:"2",children:[e.jsx(re,{size:16,className:"mb-2"}),e.jsx(d,{size:"2",children:t.cidade_nome.toLocaleUpperCase()})]}),e.jsxs(S,{align:"center",gap:"2",children:[e.jsx(le,{size:16,className:"mb-2"}),e.jsx(d,{size:"2",children:t.coordenador_responsavel})]}),e.jsxs(S,{align:"center",gap:"2",children:[e.jsx(ce,{size:16,className:"mb-2"}),e.jsx(d,{size:"2",children:t.email})]}),e.jsxs(S,{align:"center",gap:"2",children:[e.jsx(de,{size:16,className:"mb-2"}),e.jsx(d,{size:"2",children:t.telefone})]})]})]}),e.jsx(je,{my:"2",size:"4"}),e.jsxs(c,{className:"flex-grow",children:[e.jsx(w,{as:"h3",size:"3",mb:"2",color:"gray",children:"Sobre"}),e.jsx(d,{as:"p",size:"2",mb:"2",children:t.informacoes_adicionais??""})]}),e.jsx(ve,{variant:"soft",asChild:!0,size:"1",mt:"auto",children:e.jsxs(se,{to:`/instituicao/${t.id}`,children:[e.jsx(me,{size:"18",className:"mr-1"})," Perfil"]})})]}):e.jsxs(e.Fragment,{children:[e.jsx(w,{size:"5",mb:"2",children:"Bem-vindo ao Incite"}),e.jsx(d,{size:"2",children:"Explore as instituições que promovem a Agricultura Familiar Sustentável na Bahia. Clique em um marcador para saber mais."})]})})]})]})})};export{Re as default};
