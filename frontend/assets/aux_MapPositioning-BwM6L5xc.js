import{a as r,j as e,i as x,t}from"./index-tClCnJhd.js";import{r as A}from"./BahiaCidades4-BL7XSpt6.js";import{r as y}from"./heading-VWtgbdaa.js";import{o as v}from"./card-COItrLsa.js";import{o as B}from"./button-S0inrZr8.js";const b=A,w=()=>{var S;const m=r.useRef(null),u=r.useRef(null),[o,O]=r.useState([]),[n,f]=r.useState(0),[s,g]=r.useState(null),[h,j]=r.useState({}),[c,C]=r.useState(!1),[i,l]=r.useState(!1);r.useEffect(()=>{const d=[];for(const a in b)b[a].forEach(p=>{d.push({...p,id:String(p.id)})});O(d),d.length>0?console.log(`Pré-calculadora: ${d.length} cidades encontradas para processar.`):console.warn("Pré-calculadora: Nenhuma cidade encontrada nos dados. Verifique BahiaRegiaoMuni.json.")},[]),r.useEffect(()=>{if(!c||o.length===0){l(!1);return}n<o.length?(g(o[n]),l(!0)):(Object.keys(h).length>0?(console.log("----------------------------------------------------"),console.log("CENTROS DE TODAS AS CIDADES CALCULADOS (COPIE O JSON ABAIXO):"),console.log("----------------------------------------------------"),console.log(JSON.stringify(h,null,2)),console.log("----------------------------------------------------"),alert(`Processamento concluído! Verifique o console para a saída JSON de ${Object.keys(h).length} cidades.`)):o.length>0?alert("Processamento concluído, mas nenhum centro foi calculado. Verifique os logs."):alert("Nenhuma cidade para processar."),C(!1),l(!1),g(null))},[c,o,n,h]),r.useEffect(()=>{i&&s&&u.current&&m.current&&requestAnimationFrame(()=>{if(!u.current){console.warn("cityPathRef não estava pronto para medição de:",s.name),l(!1),f(a=>a+1);return}try{const a=u.current.getBBox(),p=parseFloat((a.x+a.width/2).toFixed(3)),I=parseFloat((a.y+a.height/2).toFixed(3));j(z=>({...z,[s.id]:{name:s.name,x:p,y:I}}))}catch(a){console.error(`Erro ao obter BBox para ${s.name} (ID: ${s.id}):`,a)}finally{l(!1),f(a=>a+1)}})},[i,s,m]);const P=()=>{if(o.length===0){alert("Nenhuma cidade carregada para processar. Verifique os dados de entrada.");return}console.log("Iniciando cálculo de BBox para todas as cidades..."),j({}),f(0),C(!0)};return e.jsxs(x,{className:"mt-20",style:{padding:"20px",fontFamily:"sans-serif",maxWidth:"800px"},children:[e.jsx(y,{mb:"4",children:"Utilitário de Pré-cálculo de Centros de Cidades"}),e.jsxs(v,{children:[e.jsx(B,{onClick:P,disabled:i||c&&n<o.length,size:"3",variant:"solid",children:c&&n<o.length&&!i?`Pronto para ${((S=o[n])==null?void 0:S.name)||"próxima cidade"} (${n+1}/${o.length})`:i&&s?`Processando: ${s.name}...`:"Iniciar Pré-cálculo dos Centros"}),c&&!i&&n>=o.length&&o.length>0&&e.jsx(t,{as:"p",color:"green",m:"2",children:"Cálculo Concluído! O JSON com os centros foi impresso no console."})]}),i&&s&&e.jsxs(v,{mt:"4",variant:"surface",children:[e.jsx(t,{as:"div",size:"2",weight:"bold",children:"Medindo Atualmente:"}),e.jsxs(t,{as:"div",size:"2",children:["ID: ",s.id]}),e.jsxs(t,{as:"div",size:"2",children:["Nome: ",s.name]})]}),e.jsx(x,{id:"canvas-wrapper-calculator",mt:"4",style:{width:"602px",height:"640px",overflow:"hidden",border:"1px dashed c#cc",position:"relative"},children:e.jsx("svg",{id:"SVGCanvasCalculator",ref:m,viewBox:"0 0 602 640",style:{width:"100%",height:"100%"},children:e.jsx("g",{children:i&&s&&e.jsx("path",{ref:u,d:s.d,stroke:"magenta",strokeWidth:"0.5px",fill:"rgba(255,0,255,0.1)"},s.id)})})}),e.jsxs(x,{mt:"4",p:"3",style:{background:"#f9f9f9",borderRadius:"8px"},children:[e.jsx(y,{size:"3",mb:"2",children:"Instruções de Uso:"}),e.jsx(t,{as:"p",size:"2",children:"1. Abra o console do desenvolvedor do seu navegador."}),e.jsx(t,{as:"p",size:"2",children:'2. Clique no botão "Iniciar Pré-cálculo dos Centros".'}),e.jsx(t,{as:"p",size:"2",children:"3. O utilitário irá iterar por cada cidade, renderizando seu caminho SVG e calculando o centro geométrico (BBox)."}),e.jsx(t,{as:"p",size:"2",children:"4. O progresso e quaisquer erros serão logados no console."}),e.jsx(t,{as:"p",size:"2",children:"5. Ao final, um objeto JSON contendo os IDs, nomes e centros (x, y) de todas as cidades processadas será impresso no console."}),e.jsx(t,{as:"p",size:"2",children:"6. Copie este objeto JSON."}),e.jsx(t,{as:"p",size:"2",children:"7. Salve-o como um novo arquivo (ex: `city_centers.json`) na sua pasta de assets, ou use-o para atualizar seu `BahiaRegiaoMuni.json` adicionando a propriedade `center` a cada cidade."})]})]})};export{w as default};
